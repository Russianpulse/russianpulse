db:
  image: postgres:9.4.5

memcached:
  image: memcached:1.4.27

redis:
  image: redis:3.2.3

web:
  build: .
  ports:
    - "3000:3000"
  links: 
    - db
    - memcached
    - redis
  env_file:
    - .env
  environment:
    - RAILS_ENV=development
    - DOCKER=true


worker:
  build: .
  links: 
    - db
    - memcached
    - redis
  command: bin/worker
  environment:
    - RAILS_ENV=development
    - DOCKER=true
  env_file:
    - .env
  volumes_from:
    - web

backup:
  build: containers/backup
  links: 
    - db
  env_file:
    - .env.pg-backup
